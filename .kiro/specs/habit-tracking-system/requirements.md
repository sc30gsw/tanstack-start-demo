# Requirements Document

## 導入

習慣追跡システムは、ユーザーが日々の習慣実行を記録し、継続状況をヒートマップとカレンダーで直感的に確認できるWebアプリケーションです。このシステムは、個人の習慣改善を目指すユーザーに対して、シンプル・ミニマルなインターフェースを通じて習慣形成をサポートします。

## 要件

### 要件1: 習慣管理機能
**目的:** 習慣を追跡したいユーザーとして、習慣を定義・管理できるようにしたい。これにより、記録対象となる習慣を明確に設定できる。

#### 受け入れ基準
1. WHEN ユーザーが新しい習慣を作成する THEN 習慣追跡システム SHALL 習慣名と説明を保存する
2. WHEN ユーザーが習慣名を入力する THEN 習慣追跡システム SHALL Zodスキーマによる入力値検証を実行する
3. WHEN ユーザーが既存習慣を編集する THEN 習慣追跡システム SHALL 更新された情報を保存し更新日時を記録する
4. WHEN ユーザーが習慣を削除する THEN 習慣追跡システム SHALL 関連する記録データとともに習慣を削除する
5. WHERE 習慣管理画面において THE 習慣追跡システム SHALL 作成済み習慣の一覧を表示する

### 要件2: 日次記録機能
**目的:** 日々の習慣実行を記録したいユーザーとして、その日実行した習慣と実行時間を簡単に記録できるようにしたい。これにより、習慣の実行履歴をトラッキングできる。

#### 受け入れ基準
1. WHEN ユーザーがその日の習慣実行をチェックする THEN 習慣追跡システム SHALL 実行記録をcompletedフラグとして保存する
2. WHEN ユーザーが習慣実行時間を入力する THEN 習慣追跡システム SHALL 分単位での実行時間をduration_minutesとして記録する
3. WHEN ユーザーが過去の日付を指定する THEN 習慣追跡システム SHALL 指定された日付での記録追加を許可する
4. IF 同じ習慣の同じ日付に記録が既に存在する THEN 習慣追跡システム SHALL 既存記録を更新する
5. WHERE 日次記録入力フォームにおいて THE 習慣追跡システム SHALL MantineUIコンポーネントで実装されたフォームを表示する
6. WHEN ユーザーが記録を保存する THEN 習慣追跡システム SHALL libSQL/Tursoデータベースに安全にデータを保存する

### 要件3: データ可視化機能
**目的:** 習慣の継続状況を視覚的に確認したいユーザーとして、ヒートマップとカレンダー形式で記録を確認できるようにしたい。これにより、長期的な傾向と継続パターンを把握できる。

#### 受け入れ基準
1. WHEN ユーザーがヒートマップ表示を選択する THEN 習慣追跡システム SHALL MantineのHeatmapコンポーネントで年間の継続状況を表示する
2. WHERE ヒートマップ表示において THE 習慣追跡システム SHALL 作業時間の長さに応じて色の濃度を変化させる
3. WHEN ユーザーがヒートマップの特定の日をクリックする THEN 習慣追跡システム SHALL その日の詳細記録を表示する
4. WHEN ユーザーが習慣を切り替える THEN 習慣追跡システム SHALL 選択された習慣のヒートマップを表示する
5. WHEN ユーザーがカレンダー表示を選択する THEN 習慣追跡システム SHALL MantineのCalendarコンポーネントで月間表示を行う
6. WHERE カレンダー表示において THE 習慣追跡システム SHALL 記録のある日にインジケーターを表示する
7. WHEN ユーザーがカレンダーの日付をクリックする THEN 習慣追跡システム SHALL その日の詳細記録を表示する
8. WHERE 表示切り替えオプションにおいて THE 習慣追跡システム SHALL 月/週/日表示の切り替え機能を提供する

### 要件4: データ永続化機能
**目的:** データの安全性を重視するユーザーとして、記録データが安全に保存されるようにしたい。これにより、データ損失を防ぎ、継続的に習慣追跡ができる。

#### 受け入れ基準
1. WHEN システムが初期化される THEN 習慣追跡システム SHALL DrizzleORMとlibSQL(Turso)でデータベーススキーマを作成する
2. WHERE データベース構造において THE 習慣追跡システム SHALL habits、records、settingsテーブルを定義する
3. WHEN データベース構造が変更される THEN 習慣追跡システム SHALL マイグレーション機能を実行する
4. WHILE ユーザーがデータを入力している THE 習慣追跡システム SHALL 自動保存機能を実行する
5. WHERE データベース操作において THE 習慣追跡システム SHALL データ整合性制約を強制する
6. IF データベース接続エラーが発生する THEN 習慣追跡システム SHALL 適切なエラーハンドリングとユーザー通知を実行する

### 要件5: ユーザーインターフェース
**目的:** シンプルで使いやすいインターフェースを求めるユーザーとして、迷わずに日々の記録ができるUIを使いたい。これにより、効率的で快適な習慣記録体験を得られる。

#### 受け入れ基準
1. WHERE アプリケーション全体において THE 習慣追跡システム SHALL MantineUIのテーマ設定とカスタマイズを適用する
2. WHERE ナビゲーションにおいて THE 習慣追跡システム SHALL 直感的なナビゲーション設計を提供する
3. WHERE 機能表示において THE 習慣追跡システム SHALL 必要最小限の機能のみを表示する
4. WHEN ユーザーがMacBook環境でアプリケーションを使用する THEN 習慣追跡システム SHALL 画面サイズに最適化された表示を提供する
5. WHERE アクセシビリティにおいて THE 習慣追跡システム SHALL アクセシビリティ基準への準拠を実現する
6. WHEN 画面サイズが変更される THEN 習慣追跡システム SHALL レスポンシブデザインで適応する
7. WHERE パフォーマンスにおいて THE 習慣追跡システム SHALL 初期ページロード3秒以内、データ取得・表示1秒以内を達成する