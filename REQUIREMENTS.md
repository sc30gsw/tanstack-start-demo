# プロダクトバックログ: trak-daily-habits-app

*対話モード明確化を通じて生成*

**生成日時**: 2025-09-23
**システム名**: 包括的習慣追跡アプリケーション
**技術スタック**: TanStack Start, React 19, MantineUI, Zod, Drizzle, Vite, libSQL(Turso)
**優先度**: MVP + レスポンシブデザイン
**スコープ**: 基本機能重視のミニマルインターフェース

## 📋 明確化サマリー

**元のリクエスト**: "trak-daily-habits-app" --hearing
**Q&Aを通じた詳細化**:
- **システムタイプ**: 包括的な習慣追跡Webアプリケーション
- **プラットフォーム**: デスクトップ優先（MacBook）、レスポンシブ対応
- **コア機能**: 作業時間追跡、継続記録、ヒートマップ・カレンダー可視化
- **データ管理**: クラウド同期対応（libSQL/Turso）
- **ユーザー体験**: シンプル・ミニマルなインターフェース
- **ターゲットユーザー**: 個人の習慣改善を目指すユーザー

## エピック定義

**習慣記録・可視化システム**: ユーザーが日々の習慣実行を記録し、継続状況をヒートマップとカレンダーで直感的に確認できるシンプルなWebアプリケーション

## ユーザーストーリー

### Story 1: 習慣実行記録
**As a** 日々の習慣実行を記録したいユーザー
**I want** その日実行した習慣を簡単に記録できる
**So that** 習慣の実行履歴をトラッキングできる

**受け入れ基準:**
- [ ] 習慣名を設定して記録対象の習慣を定義できる
- [ ] その日実行した習慣にチェックマークを付けられる
- [ ] 習慣の記録を日付別に確認できる
- [ ] Zodスキーマによる入力値検証が機能する
- [ ] レスポンシブデザインでMacBook画面に最適化されている

**ストーリーポイント:** 5

### Story 2: 習慣実行時間の記録
**As a** ユーザー
**I want** 習慣を実行した時間（duration）を記録できる
**So that** どれくらいの時間その習慣に取り組んだかを把握できる

**受け入れ基準:**
- [ ] 習慣実行時に作業時間（分単位）を入力できる
- [ ] 日付を指定して時間記録を追加できる
- [ ] 習慣実行記録と時間記録が連携している
- [ ] libSQL/Tursoに安全にデータが保存される
- [ ] 入力フォームがMantineUIのコンポーネントで実装されている

**ストーリーポイント:** 8

### Story 3: 継続記録の可視化（ヒートマップ）
**As a** ユーザー
**I want** 習慣の継続状況をヒートマップで確認できる
**So that** 長期的な傾向と継続パターンを把握できる

**受け入れ基準:**
- [ ] MantineのHeatmapコンポーネントで年間の継続状況を表示
- [ ] 作業時間の長さに応じて色の濃度が変化する
- [ ] 特定の日をクリックして詳細記録を確認できる
- [ ] 習慣ごとのヒートマップを切り替えて表示できる
- [ ] レスポンシブデザインで画面サイズに適応する

**ストーリーポイント:** 13

### Story 4: カレンダー表示機能
**As a** ユーザー
**I want** 習慣記録をカレンダー形式で確認できる
**So that** 月次・週次の記録を時系列で把握できる

**受け入れ基準:**
- [ ] MantineのCalendarコンポーネントで月間表示
- [ ] 記録のある日にインジケーターを表示
- [ ] 日付をクリックしてその日の詳細記録を表示
- [ ] 月/週/日表示の切り替えが可能
- [ ] タイムライン・スケジューラー的な見た目で実装

**ストーリーポイント:** 13

### Story 5: データの永続化
**As a** ユーザー
**I want** 記録データが安全に保存される
**So that** データ損失を防ぎ、継続的に習慣追跡ができる

**受け入れ基準:**
- [ ] DrizzleORMとlibSQL(Turso)でデータベース設計
- [ ] 習慣、記録、設定のテーブル作成
- [ ] データベースマイグレーション機能
- [ ] データの自動保存機能
- [ ] データ整合性の保証

**ストーリーポイント:** 8

### Story 6: ミニマルUIデザイン
**As a** ユーザー
**I want** シンプルで使いやすいインターフェース
**So that** 迷わずに日々の記録ができる

**受け入れ基準:**
- [ ] MantineUIのテーマ設定とカスタマイズ
- [ ] 直感的なナビゲーション設計
- [ ] 必要最小限の機能のみを表示
- [ ] MacBook環境での視認性最適化
- [ ] アクセシビリティ基準への準拠

**ストーリーポイント:** 5

## 技術要件

### フロントエンド技術スタック
- **TanStack Start**: SSR対応のモダンReactフレームワーク
- **React 19**: 最新のReact機能活用
- **MantineUI 8.x**: UIコンポーネントライブラリ
  - Calendar Component: 月間/週間表示
  - Heatmap Component: 継続可視化
  - Form Components: データ入力
- **Vite**: 高速ビルドツール

### バックエンド・データベース
- **Drizzle ORM**: タイプセーフなORMソリューション
- **libSQL (Turso)**: SQLiteベースのクラウドデータベース
- **Zod**: スキーマ検証ライブラリ

### アーキテクチャパターン
- ファイルベースルーティング（TanStack Start）
- Server Functions for データ操作
- 型安全なAPI設計（Zod + TypeScript）

## データベース設計

### テーブル構成

```sql
-- 習慣テーブル
CREATE TABLE habits (
  id TEXT PRIMARY KEY,
  name TEXT NOT NULL,
  description TEXT,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP
);

-- 記録テーブル
CREATE TABLE records (
  id TEXT PRIMARY KEY,
  habit_id TEXT NOT NULL REFERENCES habits(id),
  date DATE NOT NULL,
  completed BOOLEAN DEFAULT FALSE,
  duration_minutes INTEGER DEFAULT 0,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  UNIQUE(habit_id, date)
);

-- 設定テーブル
CREATE TABLE settings (
  id TEXT PRIMARY KEY,
  theme TEXT DEFAULT 'light',
  default_view TEXT DEFAULT 'calendar',
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);
```

## 非機能要件

### パフォーマンス
- 初期ページロード: 3秒以内
- データ取得・表示: 1秒以内
- ヒートマップ生成: 2秒以内

### レスポンシブデザイン
- MacBook画面サイズでの最適化
- 最小画面幅: 1280px
- 将来的なモバイル対応の考慮

### データ整合性
- Zodスキーマによる厳密な検証
- データベースレベルでの制約
- エラーハンドリングの実装

## 完了の定義

各ストーリーは以下の条件を満たした時点で完了とする：

- [ ] コードレビュー完了
- [ ] 単体テスト実装・合格
- [ ] 統合テスト合格
- [ ] レスポンシブデザインの動作確認
- [ ] アクセシビリティチェック
- [ ] ドキュメント更新

## 開発優先順序

### フェーズ1: コア機能（MVP）
1. 習慣実行記録 (Story 1)
2. 習慣実行時間の記録 (Story 2)
3. データ永続化 (Story 5)

### フェーズ2: 可視化機能
4. カレンダー表示 (Story 4)
5. ヒートマップ表示 (Story 3)

### フェーズ3: UI/UX完成
6. ミニマルUIデザイン (Story 6)

## 見積もり

**総ストーリーポイント**: 52
**推定開発期間**: 3-4スプリント
**開発チーム**: 1名（フルスタック開発者）

## リスク管理

### 技術リスク
- **MantineUI Heatmap Component**: 要件に合わない場合の代替実装検討
- **libSQL/Turso**: 接続・同期問題への対処法準備
- **React 19**: 新機能使用時の互換性確認

### 対策
- プロトタイプでの技術検証
- フォールバック実装の準備
- 段階的な機能リリース

## 成功指標

- [ ] 日々の習慣記録が5分以内で完了できる
- [ ] ヒートマップで3ヶ月以上の継続パターンが一目で把握できる
- [ ] データ損失なく安定してデータが保存される
- [ ] MacBook環境での使用体験が優秀である
- [ ] アプリケーションが安定して動作する

---

📊 **メトリクス**:
- ユーザーストーリー: 6個
- 総ストーリーポイント: 52
- 推定タイムライン: 3-4スプリント
- 技術スタック: 7つの主要技術